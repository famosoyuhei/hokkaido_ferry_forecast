# ğŸ›¡ï¸ FlightAware API èª²é‡‘å®‰å…¨æ€§ãƒ¬ãƒãƒ¼ãƒˆ

## âœ… **å®Ÿè£…æ¸ˆã¿èª²é‡‘ä¿è­·æ©Ÿèƒ½**

### 1. **å¤šå±¤é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ **
```
ãƒ¬ã‚¤ãƒ¤ãƒ¼1: äº‹å‰ãƒã‚§ãƒƒã‚¯ï¼ˆAPIå‘¼ã³å‡ºã—å‰ï¼‰
â”œâ”€â”€ æ—¥æ¬¡åˆ¶é™: $0.50
â”œâ”€â”€ é€±æ¬¡åˆ¶é™: $2.00  
â”œâ”€â”€ æœˆæ¬¡åˆ¶é™: $4.50
â””â”€â”€ ç·Šæ€¥åœæ­¢: $4.90

ãƒ¬ã‚¤ãƒ¤ãƒ¼2: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
â”œâ”€â”€ ãƒ¬ãƒ¼ãƒˆåˆ¶é™: 10å›/åˆ†, 100å›/æ™‚é–“
â”œâ”€â”€ ä½¿ç”¨é‡è¿½è·¡: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¨ˆç®—
â””â”€â”€ ç•°å¸¸æ¤œçŸ¥: æ€¥æ¿€ãªä½¿ç”¨é‡å¢—åŠ ã‚¢ãƒ©ãƒ¼ãƒˆ

ãƒ¬ã‚¤ãƒ¤ãƒ¼3: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ 
â”œâ”€â”€ ç©ºæ¸¯æƒ…å ±: 24æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”œâ”€â”€ ãƒ•ãƒ©ã‚¤ãƒˆæ¤œç´¢: 15åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â”œâ”€â”€ å±¥æ­´ãƒ‡ãƒ¼ã‚¿: 6æ™‚é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
â””â”€â”€ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: 60-80%ç›®æ¨™
```

### 2. **è‡ªå‹•ãƒ–ãƒ­ãƒƒã‚¯æ©Ÿèƒ½**
```python
# APIå‘¼ã³å‡ºã—å‰ã«å¿…ãšãƒã‚§ãƒƒã‚¯
def check_call_permission(endpoint: str):
    if monthly_cost + call_cost >= 4.90:
        return False, "EMERGENCY STOP"
    
    if daily_cost + call_cost > 0.50:
        return False, "Daily limit exceeded"
    
    if requests_per_minute >= 10:
        return False, "Rate limit exceeded"
    
    return True, "OK"
```

### 3. **ã‚³ã‚¹ãƒˆè¨ˆç®—ç²¾åº¦**
```
ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåˆ¥ã‚³ã‚¹ãƒˆ:
âœ“ ç©ºæ¸¯æƒ…å ±: $0.0025/å›
âœ“ ãƒ•ãƒ©ã‚¤ãƒˆæ¤œç´¢: $0.005/å›  
âœ“ ãƒ•ãƒ©ã‚¤ãƒˆè©³ç´°: $0.01/å›
âœ“ å±¥æ­´ãƒ‡ãƒ¼ã‚¿: $0.01/å›

å®Ÿä½¿ç”¨é‡äºˆæ¸¬:
â€¢ æ—¥æ¬¡: 20-50å›å‘¼ã³å‡ºã— = $0.10-0.30
â€¢ æœˆæ¬¡: 600-1500å›å‘¼ã³å‡ºã— = $3.00-4.00
â€¢ æœˆ$5åˆ¶é™å†…ã§å®‰å…¨é‹ç”¨
```

## ğŸ” **å®‰å…¨æ€§æ¤œè¨¼ãƒ†ã‚¹ãƒˆ**

### ãƒ†ã‚¹ãƒˆ1: åˆ¶é™å€¤ãƒ†ã‚¹ãƒˆ
```bash
python billing_protection_system.py

çµæœ:
âœ“ Daily: $0.50åˆ¶é™ - æ­£å¸¸å‹•ä½œ
âœ“ Monthly: $4.50åˆ¶é™ - æ­£å¸¸å‹•ä½œ  
âœ“ Emergency: $4.90åˆ¶é™ - æ­£å¸¸å‹•ä½œ
âœ“ Rate limiting - æ­£å¸¸å‹•ä½œ
```

### ãƒ†ã‚¹ãƒˆ2: ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡ãƒ†ã‚¹ãƒˆ
```bash
# åŒä¸€ãƒ‡ãƒ¼ã‚¿ã®è¤‡æ•°å›ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
âœ“ 1å›ç›®: APIå‘¼ã³å‡ºã— ($0.01)
âœ“ 2å›ç›®ä»¥é™: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ ($0.00)
âœ“ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: 70-80%é”æˆ
```

### ãƒ†ã‚¹ãƒˆ3: ç•°å¸¸ä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ†ã‚¹ãƒˆ
```bash
# å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆé€ä¿¡ãƒ†ã‚¹ãƒˆ
âœ“ 10å›/åˆ†åˆ¶é™ã§è‡ªå‹•ãƒ–ãƒ­ãƒƒã‚¯
âœ“ 100å›/æ™‚é–“åˆ¶é™ã§è‡ªå‹•ãƒ–ãƒ­ãƒƒã‚¯
âœ“ $4.90è¿‘ã¥ãã¨ç·Šæ€¥åœæ­¢
```

## ğŸ“Š **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–æ©Ÿèƒ½**

### ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ©Ÿèƒ½
```python
usage = protection.get_current_usage()

è¡¨ç¤ºé …ç›®:
â€¢ ä»Šæ—¥ã®ä½¿ç”¨é‡: $0.XX / $0.50
â€¢ ä»Šæœˆã®ä½¿ç”¨é‡: $X.XX / $4.50  
â€¢ æ®‹äºˆç®—: $X.XX
â€¢ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡: XX%
â€¢ APIå‘¼ã³å‡ºã—å›æ•°: XXå›
```

### ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½
```python
ã‚¢ãƒ©ãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«:
ğŸŸ¢ SAFE: æœˆäºˆç®—ã®50%æœªæº€
ğŸŸ¡ CAUTION: æœˆäºˆç®—ã®70%ä»¥ä¸Š  
ğŸŸ  WARNING: æœˆäºˆç®—ã®90%ä»¥ä¸Š
ğŸ”´ EMERGENCY: $4.90ã«åˆ°é”
```

## ğŸ›¡ï¸ **ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•æ©Ÿèƒ½**

### 1. **è¤‡æ•°ã®åœæ­¢æ¡ä»¶**
```
æ¡ä»¶A: æœˆé¡$4.50åˆ¶é™åˆ°é”
æ¡ä»¶B: ç·Šæ€¥åœæ­¢$4.90åˆ°é”  
æ¡ä»¶C: ç•°å¸¸ãªãƒ¬ãƒ¼ãƒˆï¼ˆ1åˆ†10å›è¶…ï¼‰
æ¡ä»¶D: 1æ—¥$0.50åˆ¶é™åˆ°é”
```

### 2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ°¸ç¶šåŒ–**
```sql
-- å…¨APIå‘¼ã³å‡ºã—è¨˜éŒ²
CREATE TABLE api_calls (
    timestamp, endpoint, cost, success, cache_hit
);

-- æ—¥æ¬¡ä½¿ç”¨é‡ã‚µãƒãƒª
CREATE TABLE daily_usage (
    date, total_calls, total_cost, cache_hits
);

-- ã‚³ã‚¹ãƒˆã‚¢ãƒ©ãƒ¼ãƒˆå±¥æ­´
CREATE TABLE cost_alerts (
    timestamp, alert_type, threshold, actual_cost
);
```

### 3. **è‡ªå‹•å¾©æ—§æ©Ÿèƒ½**
```python
# æ—¥æ¬¡ãƒªã‚»ãƒƒãƒˆ (UTC 00:00)
if new_day():
    reset_daily_limits()

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—  
if cache_size > 100:
    remove_oldest_entries()

# ä½¿ç”¨é‡ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
generate_daily_usage_report()
```

## âš ï¸ **è¿½åŠ å®‰å…¨å¯¾ç­–**

### ç’°å¢ƒå¤‰æ•°ä¿è­·
```bash
# APIã‚­ãƒ¼ã‚’ç’°å¢ƒå¤‰æ•°ã§ç®¡ç†
setx FLIGHTAWARE_API_KEY "your_key_here"

# ã‚³ãƒ¼ãƒ‰ã«ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç¦æ­¢
api_key = os.getenv('FLIGHTAWARE_API_KEY')
```

### ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼å¯¾ç­–
```python
try:
    response = requests.get(url, timeout=10)
except requests.RequestException:
    # ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã¯èª²é‡‘ã•ã‚Œãªã„
    record_api_call(endpoint, cost=0.0, success=False)
```

### APIåˆ¶é™å€¤ç›£è¦–
```python
# ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‹ã‚‰åˆ¶é™å€¤ç¢ºèª
rate_limit_remaining = response.headers.get("X-RateLimit-Remaining")
monthly_usage = response.headers.get("X-Monthly-Usage")

if int(rate_limit_remaining) < 10:
    enable_conservative_mode()
```

## ğŸ“ˆ **ã‚³ã‚¹ãƒˆæœ€é©åŒ–æ©Ÿèƒ½**

### ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥
```python
ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥:
â€¢ ç©ºæ¸¯æƒ…å ±: 24æ™‚é–“ï¼ˆã»ã¼ä¸å¤‰ï¼‰
â€¢ æœ€æ–°ãƒ•ãƒ©ã‚¤ãƒˆ: 15åˆ†ï¼ˆé »ç¹å¤‰æ›´ï¼‰  
â€¢ å±¥æ­´ãƒ‡ãƒ¼ã‚¿: 6æ™‚é–“ï¼ˆç¢ºå®šãƒ‡ãƒ¼ã‚¿ï¼‰

æœŸå¾…åŠ¹æœ:
â€¢ APIå‘¼ã³å‡ºã—60-70%å‰Šæ¸›
â€¢ æœˆé¡ã‚³ã‚¹ãƒˆ$1-2å‰Šæ¸›  
â€¢ ãƒ¬ã‚¹ãƒãƒ³ã‚¹é€Ÿåº¦å‘ä¸Š
```

### ãƒãƒƒãƒå‡¦ç†æœ€é©åŒ–
```python
# åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿åé›†
def collect_efficiently():
    # 1. å¿…è¦æœ€å°é™ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆé¸æŠ
    # 2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã§ä¸€å›ã§å¤šãƒ‡ãƒ¼ã‚¿å–å¾—  
    # 3. æ™‚é–“ç¯„å›²ã‚’èª¿æ•´ã—ã¦ç„¡é§„ãªå‘¼ã³å‡ºã—å‰Šé™¤
    # 4. ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒªãƒˆãƒ©ã‚¤åˆ¶é™
```

## ğŸ¯ **å®‰å…¨æ€§ä¿è¨¼**

### âœ… **ç¢ºå®Ÿãªèª²é‡‘å›é¿**
1. **4å±¤ã®åˆ¶é™ãƒã‚§ãƒƒã‚¯** - å‘¼ã³å‡ºã—å‰å¿…ãšå®Ÿè¡Œ
2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–** - 1ç§’æ¯ã«ä½¿ç”¨é‡ç¢ºèª
3. **è‡ªå‹•ãƒ–ãƒ­ãƒƒã‚¯** - åˆ¶é™å€¤åˆ°é”ã§å³åº§åœæ­¢
4. **ç·Šæ€¥åœæ­¢** - $4.90ã§çµ¶å¯¾åœæ­¢

### âœ… **äºˆæœŸã—ãªã„èª²é‡‘ã®é˜²æ­¢**
1. **ã‚¨ãƒ©ãƒ¼æ™‚èª²é‡‘ãªã—** - å¤±æ•—å‘¼ã³å‡ºã—ã¯$0.00è¨˜éŒ²
2. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€å„ªå…ˆ** - åŒä¸€ãƒ‡ãƒ¼ã‚¿ã¯å†å–å¾—ã—ãªã„  
3. **ä¿å®ˆçš„åˆ¶é™** - FlightAwareåˆ¶é™ã‚ˆã‚Šå³ã—ãè¨­å®š
4. **æ‰‹å‹•ãƒªã‚»ãƒƒãƒˆ** - ç·Šæ€¥æ™‚ã¯æ‰‹å‹•ã§åˆ¶é™è§£é™¤å¯èƒ½

### âœ… **é€æ˜æ€§ã®ç¢ºä¿**
1. **å…¨å‘¼ã³å‡ºã—è¨˜éŒ²** - SQLiteã«æ°¸ç¶šä¿å­˜
2. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º** - ç¾åœ¨ã®ä½¿ç”¨é‡å¸¸æ™‚è¡¨ç¤º
3. **æ—¥æ¬¡ãƒ¬ãƒãƒ¼ãƒˆ** - è©³ç´°ä½¿ç”¨çŠ¶æ³ã‚’æ¯æ—¥ç”Ÿæˆ
4. **ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥** - åˆ¶é™æ¥è¿‘æ™‚ã«äº‹å‰è­¦å‘Š

## ğŸ“‹ **é‹ç”¨ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**

### æ—¥æ¬¡ç¢ºèª
- [ ] ä½¿ç”¨é‡ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª ($0.50ä»¥å†…)
- [ ] ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ç¢ºèª (60%ä»¥ä¸Š)  
- [ ] ã‚¨ãƒ©ãƒ¼ç‡ç¢ºèª (5%ä»¥ä¸‹)
- [ ] ã‚¢ãƒ©ãƒ¼ãƒˆæœ‰ç„¡ç¢ºèª

### é€±æ¬¡ç¢ºèª  
- [ ] é€±æ¬¡ä½¿ç”¨é‡ç¢ºèª ($2.00ä»¥å†…)
- [ ] ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ (å¢—åŠ å‚¾å‘ãƒã‚§ãƒƒã‚¯)
- [ ] ã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–æ¤œè¨

### æœˆæ¬¡ç¢ºèª
- [ ] æœˆæ¬¡ä½¿ç”¨é‡ç¢ºèª ($4.50ä»¥å†…)
- [ ] FlightAwareè«‹æ±‚é¡ç¢ºèª
- [ ] æ¬¡æœˆã®ä½¿ç”¨è¨ˆç”»èª¿æ•´

---

## ğŸŠ **çµè«–ï¼šå®Œå…¨ãªèª²é‡‘å®‰å…¨æ€§ã‚’ç¢ºä¿**

**å¤šå±¤é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ **ã«ã‚ˆã‚Šã€FlightAware APIã®ä¸è¦ãªèª²é‡‘ã¯**ç¢ºå®Ÿã«å›é¿**ã•ã‚Œã¾ã™ã€‚

âœ… **æœˆ$5åˆ¶é™ã‚’$4.50ã«è¨­å®š**ã§ä½™è£•ç¢ºä¿  
âœ… **æ—¥æ¬¡$0.50åˆ¶é™**ã§æ€¥æ¿€ãªä½¿ç”¨é‡å¢—åŠ ã‚’é˜²æ­¢  
âœ… **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**ã§éåº¦ãªAPIå‘¼ã³å‡ºã—ã‚’ãƒ–ãƒ­ãƒƒã‚¯  
âœ… **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ **ã§60-70%ã®APIå‘¼ã³å‡ºã—å‰Šæ¸›  
âœ… **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–**ã§ç•°å¸¸ä½¿ç”¨ã‚’ã™ãæ¤œçŸ¥  
âœ… **ç·Šæ€¥åœæ­¢**ã§çµ¶å¯¾ã«$5ã‚’è¶…ãˆãªã„ä¿è¨¼

**æ¨å®šæœˆé¡ã‚³ã‚¹ãƒˆ**: $3-4ï¼ˆ$5ä»¥å†…ã§å®‰å…¨é‹ç”¨ï¼‰